<div ng-controller="NewpollwizardresultsCtrl" class="newPollWizardStep pollWizardResultsContainer">
    <div class="progressAndPrintContainer">
        <new-poll-wizard-progress step="3"></new-poll-wizard-progress>
        <div class="printAndExport">
            <i class="fa fa-lg fa-file" title="{{'polling.polling_logs_table_header_export_as_csv' | i18n }}" ng-click="exportAsFile()"></i>
            <i class="fa fa-lg fa-print" title="{{'polling.polling_logs_table_header_print_page' | i18n }}" ng-click="print()"></i>
        </div>    
    </div>    

    <div class="row" ng-if="currentResult.programPoll">
        <div class="col-md-12">
            <table class="searchResults colorOdd pollingLogsTable">
                <thead>
                    <tr>
                        <th><input type="checkbox" onclick="alert('Please don not click this button!')"/></th>
                        <th sortable-table-header by="currentResult.sortBy" reverse="currentResult.sortReverse">
                            {{ 'polling.polling_logs_table_header_name' | i18n }}
                        </th>
                        <th sortable-table-header by="currentResult.sortBy" reverse="currentResult.sortReverse">
                            {{ 'polling.polling_logs_table_header_transponder' | i18n }}
                        </th>
                        <th>{{ 'polling.running_program_polls_table_header_start_date' | i18n }}</th>
                        <th>{{ 'polling.running_program_polls_table_header_end_date' | i18n }}</th>
                        <th>{{ 'polling.running_program_polls_table_header_interval' | i18n }}</th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="item in currentResult.polls | orderBy:currentResult.sortBy:currentResult.sortReverse">
                        <td><input type="checkbox" onclick="alert('Please do not click this button!')"/></td>
                        <td>{{ item.attributes.VESSEL_NAME }} </td>
                        <td>{{ item.attributes.TRANSPONDER }} </td>
                        <td>{{ item.attributes.START_DATE | date : "medium" }}</td>
                        <td>{{ item.attributes.END_DATE | date : "medium" }}</td>
                        <td>{{ item.getFrequencyAsText() }}</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <div ng-if="!currentResult.programPoll" class="row">
        <div class="col-md-12">
            <table class="searchResults colorOdd pollingLogsTable">
                <thead>
                    <tr>
                        <th><input type="checkbox"/></th>
                        <th sortable-table-header by="currentResult.sortBy" reverse="currentResult.sortReverse" order="'associatedVessel.name'">{{'polling.polling_logs_table_header_name' | i18n}}</th>

                        <th sortable-table-header by="currentResult.sortBy" reverse="currentResult.sortReverse" order="'transponder'">{{'polling.polling_logs_table_header_transponder' | i18n}}</th>  

                        <th sortable-table-header by="currentResult.sortBy" reverse="currentResult.sortReverse" order="'time'" class="times">{{'polling.polling_logs_table_header_time' | i18n}}</th>
    
                        <th>{{'polling.polling_logs_table_header_status' | i18n}}</th>
                        <th>{{'polling.polling_logs_table_header_results' | i18n}}</th>
                        <th>{{'polling.polling_logs_table_header_logs' | i18n}}</th>
                    </tr>
                </thead>
                <tbody>
                <tr ng-repeat="item in currentResult.polls | orderBy:currentResult.sortBy:currentResult.sortReverse" ng-init="isExpanded = false">            
                    <td><input type="checkbox"/></td>
                    <td>{{item.attributes.VESSEL_NAME}}</td>
                    <td>{{item.attributes.TRANSPONDER}}</td>
                    <td class="statusTime">
                        <div class="expandIcon" ng-show="item.status.length > 1" ng-click="isExpanded = !isExpanded">
                            <i class="fa fa-plus-square" ng-show="!isExpanded"></i>
                            <i class="fa fa-minus-square" ng-show="isExpanded"></i>
                        </div>
                        <div class="times">
                            <span ng-repeat="status in item.status" ng-show="isExpanded || $index === 0">
                                {{status.time | date : "medium"}}<br>
                            </span>
                        </div>
                    </td>
                    <td class="statusText">
                        <span ng-repeat="status in item.status" ng-show="isExpanded  || $index === 0" ng-class="{'success': status.text === 'Succeeded', 'failed': status.text === 'Request failed'}">
                            {{status.text}}<br>
                        </span>
                    </td>
                    <td><a>{{'polling.polling_logs_table_results_link' | i18n}}</a></td>
                    <td><a>{{'polling.polling_logs_table_logs_link' | i18n}}</a></td> 
                </tr>
                </tbody>
            </table>
        </div>
    </div>

    <div class="row wizardFooter">
        <div class="col-md-12 textAlignRight">
            <button type="button" class="btn btn-primary" ng-click="startNewPoll()">{{'polling.wizard_third_step_new_poll_button' | i18n | uppercase}}</button>
        </div>        
    </div>        

</div>
