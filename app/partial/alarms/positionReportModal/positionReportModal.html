<div class="modal-header" style="text-align:left">
    <div class="pointer pull-right" ng-click="cancel()">
        <i class="fa fa-times closeicon"></i>
    </div>
    <h4 class="modal-title">{{ 'alarms.position_report_header' | i18n }}</h4>
</div>

<div class="modal-body">

    <div class="row">
        <div class="col-md-12">
            {{'common.status' | i18n}}
            <span class="label" ng-class="{'label-success': alarm.isClosed(), 'label-danger': alarm.isOpen(), 'label-warning': !alarm.isClosed() && !alarm.isOpen()}">
                {{getStatusLabel(alarm) | uppercase}}
            </span>

            {{'alarms.position_report_recipient' | i18n}}  <b>TODO: What should be here???</b>
        </div>
    </div>

    <div>
        <div class="row">
            <div class="col-md-12">
                <div class="sectionHeader">
                    {{'alarms.position_report_asset_information' | i18n}}
                </div>
                <span class="assignAssetLink" ng-click="toggleAssignAsset()" ng-if="!readOnly && !knownVessel">{{'alarms.position_report_assign_asset_from_list' | i18n}}</span>
            </div>
        </div>
        <div class="row">
            <div class="col-md-3">
                <label>{{'movement.manual_position_field_label_flag_state' | i18n}}</label>
                <div class="value" ng-show="alarm.placeholderVessel">{{alarm.placeholderVessel.countryCode}}</div>
                <div class="value" ng-show="!alarm.placeholderVessel && alarm.vessel">{{alarm.vessel.countryCode}}</div>
                <div class="value" ng-show="!alarm.placeholderVessel && !alarm.vessel && alarm.asset.ids.FLAG_STATE">{{alarm.asset.ids.FLAG_STATE}}</div>
                <div class="value missing" ng-show="!alarm.placeholderVessel && !alarm.vessel && !alarm.asset.ids.FLAG_STATE">{{'alarms.position_report_asset_information_value_missing' | i18n}}</div>
            </div>
            <div class="col-md-3">
                <label>{{'movement.manual_position_field_label_ircs' | i18n}}</label>
                <div class="value" ng-show="alarm.placeholderVessel">{{alarm.placeholderVessel.ircs}}</div>
                <div class="value" ng-show="!alarm.placeholderVessel && alarm.vessel">{{alarm.vessel.ircs}}</div>
                <div class="value" ng-show="!alarm.placeholderVessel && !alarm.vessel && alarm.asset.ids.IRCS">{{alarm.asset.ids.IRCS}}</div>
                <div class="value missing" ng-show="!alarm.placeholderVessel && !alarm.vessel && !alarm.asset.ids.IRCS">{{'alarms.position_report_asset_information_value_missing' | i18n}}</div>
            </div>
            <div class="col-md-3">
                <label>{{'movement.manual_position_field_label_cfr' | i18n}}</label>
                <div class="value" ng-show="alarm.placeholderVessel">{{alarm.placeholderVessel.cfr}}</div>
                <div class="value" ng-show="!alarm.placeholderVessel && alarm.vessel">{{alarm.vessel.cfr}}</div>
                <div class="value" ng-show="!alarm.placeholderVessel && !alarm.vessel && alarm.asset.ids.CFR">{{alarm.asset.ids.CFR}}</div>
                <div class="value missing" ng-show="!alarm.placeholderVessel && !alarm.vessel && !alarm.asset.ids.CFR">{{'alarms.position_report_asset_information_value_missing' | i18n}}</div>
            </div>
            <div class="col-md-3">
                <label>{{'movement.manual_position_field_label_external_marking' | i18n}}</label>
                <div class="value" ng-show="alarm.placeholderVessel">{{alarm.placeholderVessel.externalMarking}}</div>
                <div class="value" ng-show="!alarm.placeholderVessel && alarm.vessel">{{alarm.vessel.externalMarking}}</div>
                <div class="value" ng-show="!alarm.placeholderVessel && !alarm.vessel && alarm.asset.ids.EXTERNAL_MARKING">{{alarm.asset.ids.EXTERNAL_MARKING}}</div>
                <div class="value missing" ng-show="!alarm.placeholderVessel && !alarm.vessel && !alarm.asset.ids.EXTERNAL_MARKING">{{'alarms.position_report_asset_information_value_missing' | i18n}}</div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-3">
                <label>{{'movement.manual_position_field_label_name' | i18n}}</label>
                <div class="value" ng-show="alarm.placeholderVessel">{{alarm.placeholderVessel.name}}</div>
                <div class="value" ng-show="!alarm.placeholderVessel && alarm.vessel">{{alarm.vessel.name}}</div>
                <div class="value" ng-show="!alarm.placeholderVessel && !alarm.vessel && alarm.asset.ids.NAME">{{alarm.asset.ids.NAME}}</div>
                <div class="value missing" ng-show="!alarm.placeholderVessel && !alarm.vessel && !alarm.asset.ids.NAME">{{'alarms.position_report_asset_information_value_missing' | i18n}}</div>
            </div>
        </div>

        <div class="row" ng-show="isVisible.assignAsset">
            <div class="col-md-12">
                <div class="searchVesselContainer">
                    <div class="row searchFormContainer">
                        <form>
                            <!-- Search input -->
                            <div class="col-md-5">
                                <input type="text" class="form-control searchText" placeholder="{{'vessel.search_vessel_placeholder' | i18n}}" ng-model="assignAssetSearchText">
                            </div>

                            <!-- Type Dropdown -->
                            <div class="col-md-5">
                                <dropdown ng-model="assignAssetSearchType" no-placeholder-item items="assignAssetSearchTypes"></dropdown>
                            </div>

                            <!-- Search button -->
                            <div class="col-md-2">
                                <button type="submit" class="btn btn-primary btn-sm searchButton" ng-click="searchVessel()" ng-disabled="!assignAssetSearchText">
                                    <span class="fa fa-search" aria-hidden="true"></span>
                                </button>
                            </div>
                        </form>
                    </div>
                    <div class="row">
                        <div search-results-table search="currentSearchResults" class="col-md-12">
                            <table class="searchResults colorOdd" ng-show="currentSearchResults.items.length > 0">
                                <thead>
                                    <tr>
                                        <th sortable-table-header by="currentSearchResults.sortBy" reverse="currentSearchResults.sortReverse" order="'ircs'">{{"vessel.ircs" | i18n}}</th>
                                        <th sortable-table-header by="currentSearchResults.sortBy" reverse="currentSearchResults.sortReverse" order="'name'">{{"vessel.name" | i18n}}</th>
                                        <th sortable-table-header by="currentSearchResults.sortBy" reverse="currentSearchResults.sortReverse" order="'cfr'">{{"vessel.cfr" | i18n}}</th>
                                        <th sortable-table-header by="currentSearchResults.sortBy" reverse="currentSearchResults.sortReverse" order="'externalMarking'">{{"vessel.external_marking" | i18n}}</th>
                                        <th>&nbsp;</th>
                                    </tr>
                                </thead>
                                <tr ng-repeat="vessel in currentSearchResults.items | orderBy:currentSearchResults.sortBy:currentSearchResults.sortReverse">
                                    <td>{{vessel.ircs}}</td>
                                    <td>{{vessel.name}}</td>
                                    <td>{{vessel.cfr}}</td>
                                    <td>{{vessel.externalMarking}}</td>
                                    <td class="textAlignRight">
                                        <button ng-show="!alarm.placeholderVessel || !vessel.equals(alarm.placeholderVessel)" type="button" class="btn btn-primary" ng-click="selectVessel(vessel)">
                                            {{"common.add" | i18n | uppercase}}
                                        </button>
                                        <button ng-show="alarm.placeholderVessel && vessel.equals(alarm.placeholderVessel)" type="button" class="btn btn-success" ng-click="unselectVessel(vessel)">
                                            {{"common.added" | i18n | uppercase}}
                                        </button>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <search-results-pagination page='currentSearchResults.page' total='currentSearchResults.totalNumberOfPages' callback='gotoPage'></search-results-pagination >
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12">
                <div class="sectionHeader">
                    {{'alarms.position_report_position_information' | i18n}}
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-3">
                <label>{{'movement.manual_position_field_label_status' | i18n}}</label>
                <div class="value">{{alarm.movement.movement.status}}</div>
            </div>
            <div class="col-md-9">
                <label>{{'movement.manual_position_field_label_date_time' | i18n}}</label>
                <div class="value">{{alarm.movement.time | confDateFormat}}</div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-3">
                <label>{{'movement.manual_position_field_label_latitude' | i18n}}</label>
                <div class="value">{{alarm.movement.movement.latitude | confCoordinateFormat}}</div>
            </div>
            <div class="col-md-3">
                <label>{{'movement.manual_position_field_label_longitude' | i18n}}</label>
                <div class="value">{{alarm.movement.movement.longitude | confCoordinateFormat}}</div>
            </div>
            <div class="col-md-3">
                <label>{{'movement.manual_position_field_label_measured_speed' | i18n}}</label>
                <div class="value">{{alarm.movement.movement.reportedSpeed}} {{"movement.manual_position_field_unit_knots" | i18n}}</div>
            </div>
            <div class="col-md-3">
                <label>{{'movement.manual_position_field_label_course' | i18n}}</label>
                <div class="value">{{alarm.movement.movement.reportedCourse}} {{"movement.manual_position_field_unit_degrees" | i18n}}</div>
            </div>
        </div>
    </div>

    <div ng-if="modalStatusText" ng-class="modalStatusClass" class="alert" style="padding: 5px 15px; margin: 15px -10px;">
        {{ modalStatusText }}
    </div>

    <div class="mapContainer">
        <leaflet center="center" markers="markers" height="200px" width="100%"></leaflet>
    </div>

    <div class="row" ng-if="!readOnly">
        <div class="col-md-12">
            <div class="sectionHeader">
                {{'common.actions' | i18n}}
            </div>
        </div>
        <div class="col-md-12">
            <input type="checkbox" ng-model="inactivePosition"/> <span ng-click="inactivePosition = !inactivePosition;">
                {{'alarms.position_report_inactivate_position' | i18n}}
            </span>
        </div>
    </div>

</div>

<div class="modal-footer">
    <div class="row buttons" ng-if="!readOnly">
        <div class="buttonGroups">
            <div class="buttonGroup">
                <a class="button" ng-click="cancel()">{{"common.cancel" | i18n}}</a>
            </div>
            <div class="buttonGroup button-group-right">
                <a ng-show="acceptAndPollIsAllowed()" class="button" ng-click="acceptAndPoll()">
                    {{"alarms.position_report_accept_and_poll" | i18n}}
                </a>

                <button class="btn btn-danger button" type="submit" ng-click="reject()">
                    <i class="fa fa-times"></i> {{"alarms.position_report_reject" | i18n}}
                </button>
                <button class="btn btn-success button" type="submit" ng-click="accept()">
                    <i class="fa fa-check"></i> {{"alarms.position_report_accept" | i18n}}
                </button>
            </div>
        </div>
    </div>
    <div class="row buttons" ng-if="readOnly">
        <div class="buttonGroup button-group-right">
            <button class="btn btn-primary button" ng-click="cancel()">
                {{"common.close" | i18n}}
            </button>
        </div>
    </div>
</div>
