<!--
﻿Developed with the contribution of the European Commission - Directorate General for Maritime Affairs and Fisheries
© European Union, 2015-2016.

This file is part of the Integrated Fisheries Data Management (IFDM) Suite. The IFDM Suite is free software: you can
redistribute it and/or modify it under the terms of the GNU General Public License as published by the
Free Software Foundation, either version 3 of the License, or any later version. The IFDM Suite is distributed in
the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more details. You should have received a
copy of the GNU General Public License along with the IFDM Suite. If not, see <http://www.gnu.org/licenses/>.
-->
<div class="mobileTerminalHistoryModal">
    <div class="modal-header" style="text-align:left">
        <div class="pointer pull-right" ng-click="cancel()" id="mob-term-history-cancel-1">
            <i class="fa fa-times closeicon"></i>
        </div>
        <h4 class="modal-title">{{ 'mobileTerminal.history_modal_header' | i18n}}</h4>
    </div>

    <div class="modal-body">
        <div class="row">
           <div class="col-md-12">
                <span class="transponderType" id="mob-term-history-transponder-type">{{'mobileTerminal.history_modal_transpondertype' | i18n }}: <b>{{ mobileTerminal.type | transponderName}}</b></span>
            </div>
        </div>
        <div class="row">
            <div search-results-table search="currentSearchResults" class="col-md-12">
                <table class="searchResults colorOdd truncate-text">
                    <thead>
                        <tr>
                            <th sortable-table-header by="currentSearchResults.sortBy" reverse="currentSearchResults.sortReverse" order="'eventCode'">{{'mobileTerminal.history_modal_eventcode' | i18n }}</th>
                            <th sortable-table-header by="currentSearchResults.sortBy" reverse="currentSearchResults.sortReverse" order="'mobileTerminal.associatedVessel.name'">{{'mobileTerminal.history_modal_vesselname' | i18n }}</th>
                            <th sortable-table-header by="currentSearchResults.sortBy" reverse="currentSearchResults.sortReverse" order="'mobileTerminal.attributes.SERIAL_NUMBER'">{{'mobileTerminal.history_modal_serialnumber' | i18n }}</th>
                            <th sortable-table-header by="currentSearchResults.sortBy" reverse="currentSearchResults.sortReverse" order="'mobileTerminal.channels[0].ids.DNID'">{{'mobileTerminal.history_modal_dnid' | i18n }}</th>
                            <th sortable-table-header by="currentSearchResults.sortBy" reverse="currentSearchResults.sortReverse" order="'mobileTerminal.channels[0].ids.MEMBER_NUMBER'">{{'mobileTerminal.history_modal_memberno' | i18n }}</th>
                            <th sortable-table-header by="currentSearchResults.sortBy" reverse="currentSearchResults.sortReverse" order="'mobileTerminal.attributes.INSTALLED_ON'">{{'mobileTerminal.history_modal_installed' | i18n }}</th>
                            <th sortable-table-header by="currentSearchResults.sortBy" reverse="currentSearchResults.sortReverse" order="'mobileTerminal.attributes.UNINSTALLED_ON'">{{'mobileTerminal.history_modal_uninstalled' | i18n }}</th>
                            <th sortable-table-header by="currentSearchResults.sortBy" reverse="currentSearchResults.sortReverse" order="'mobileTerminal.attributes.SATELLITE_NUMBER'">{{'mobileTerminal.history_modal_satelliteno' | i18n }}</th>
                            <th sortable-table-header by="currentSearchResults.sortBy" reverse="currentSearchResults.sortReverse" order="'changeDate'">{{'mobileTerminal.history_modal_changeddate' | i18n }}</th>
                            <th sortable-table-header by="currentSearchResults.sortBy" reverse="currentSearchResults.sortReverse" order="'comment'">{{'mobileTerminal.history_modal_comments' | i18n }}</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr ng-repeat="item in currentSearchResults.items | orderBy:currentSearchResults.sortBy:currentSearchResults.sortReverse">
                            <td>{{item.eventCode}}</td>
                            <td>
                                <span ng-show="item.mobileTerminal.associatedVessel"><a href="#/assets/{{item.mobileTerminal.associatedVessel.getGuid()}}" title="{{'common.view_details' | i18n}}" ng-click="cancel()" id="mob-term-history-to-vessel">{{item.mobileTerminal.associatedVessel.name}}</a></span>
                                <span ng-show="item.mobileTerminal.connectId && !item.mobileTerminal.associatedVessel">ConnectId: {{item.mobileTerminal.connectId}}</span>
                            </td>
                            <td>{{item.serialNumber}}</td>
                            <td>
                                <span ng-repeat="channel in item.comChannelHistory">
                                    <span ng-if="channel.comChannelInfo">
                                        <span ng-repeat="channelInfo in channel.comChannelInfo">
                                            <span ng-repeat="attribute in channelInfo.attributes" ng-if="attribute.type == 'DNID' && attribute.value">
                                                {{attribute.value}}
                                            </span>
                                        </span>
                                    </span>
                                </span>
                            </td>
                            <td>
                                <span ng-repeat="channel in item.comChannelHistory">
                                    <span ng-if="channel.comChannelInfo">
                                        <span ng-repeat="channelInfo in channel.comChannelInfo">
                                            <span ng-repeat="attribute in channelInfo.attributes" ng-if="attribute.type == 'MEMBER_NUMBER' && attribute.value">
                                                {{attribute.value}}
                                            </span>
                                        </span>
                                    </span>
                                </span>
                            </td>
                            <td>
                                <span ng-repeat="channel in item.comChannelHistory">
                                    <span ng-if="channel.comChannelInfo">
                                        <span ng-repeat="channelInfo in channel.comChannelInfo">
                                            {{channelInfo.installed | confDateFormat}}
                                        </span>
                                    </span>
                                </span>
                            </td>
                            <td>
                                <span ng-repeat="channel in item.comChannelHistory">
                                    <span ng-if="channel.comChannelInfo">
                                        <span ng-repeat="channelInfo in channel.comChannelInfo">
                                            {{channelInfo.uninstalled | confDateFormat}}
                                        </span>
                                    </span>
                                </span>
                            </td>
                            <td>{{item.satelliteNumber}}</td>
                            <td>{{item.changeDate | confDateFormat}}</td>
                            <td>{{item.comment}}</td>
                        </tr>
                     </tbody>
                </table>
            </div>
        </div>
    </div>
    <div class="modal-footer">
        <div class="row">
            <div class="col-md-12">
                <button type="button" class="btn btn-primary" ng-click="cancel()" id="mob-term-history-cancel-2">{{ 'common.close' | i18n | uppercase}}</button>
            </div>
        </div>
    </div>
</div>
